From c1c1b92c319d978d3b05dc9a625c7f3bec9fe2d8 Mon Sep 17 00:00:00 2001
From: Martin Preisler <mpreisle@redhat.com>
Date: Thu, 16 Jul 2015 13:35:23 +0200
Subject: [PATCH] Show RHSA identifiers as clickable links in HTML report and
 guide

This fixes a regression between openscap 1.0.x and 1.1.x.
See rhbz#1243808.
---
 xsl/xccdf-share.xsl | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/xsl/xccdf-share.xsl b/xsl/xccdf-share.xsl
index 8fdd862..700417d 100644
--- a/xsl/xccdf-share.xsl
+++ b/xsl/xccdf-share.xsl
@@ -53,6 +53,9 @@ Authors:
         <xsl:when test="starts-with(@system, 'http://cve.mitre.org')">
             <a href="{concat('https://cve.mitre.org/cgi-bin/cvename.cgi?name=', text())}"><abbr title="{concat(@system, concat(': ', text()))}"><xsl:value-of select="text()"/></abbr></a>
         </xsl:when>
+        <xsl:when test="starts-with(@system, 'https://rhn.redhat.com/errata')">
+            <a href="{concat('https://rhn.redhat.com/errata/', concat(text(), '.html'))}"><abbr title="{concat(@system, concat(': ', text()))}"><xsl:value-of select="text()"/></abbr></a>
+        </xsl:when>
         <xsl:otherwise>
             <abbr title="{concat(@system, concat(': ', text()))}"><xsl:value-of select="text()"/></abbr>
         </xsl:otherwise>
